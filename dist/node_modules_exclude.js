"use strict";
const excludeConfig = require("./exclude_config.json");
class NodeModulesExclude {
    constructor(serverless, options) {
        this.serverless = serverless;
        this.options = options;
        this.hooks = {
            'after:deploy:function:initialize': this.extendExcludes.bind(this),
            'after:package:initialize': this.extendExcludes.bind(this)
        };
    }
    _appendRootExcludes(excludes) {
        return excludes ? excludeConfig.root.sort().concat(excludes) : excludeConfig.root.sort();
    }
    _appendNodeExcludes(excludes) {
        let nodeExcludesFullPath = excludeConfig.node_modules.map(val => ("node_modules/**/" + val)).sort();
        return excludes ? nodeExcludesFullPath.concat(excludes) : nodeExcludesFullPath;
    }
    extendExcludes() {
        const service = this.serverless.service;
        service.package = service.package || {};
        let exclude = service.package.exclude || [];
        service.package.exclude = this._appendNodeExcludes(service.package.exclude);
        service.package.exclude = this._appendRootExcludes(service.package.exclude);
    }
}
module.exports = NodeModulesExclude;
//# sourceMappingURL=node_modules_exclude.js.map